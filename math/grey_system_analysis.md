---
author: lunar
date: Fri 28 Aug 2020 09:55:24 PM CST
---

## 灰色关联系分析与预测模型

### 灰色预测的概念

#### 灰色系统、白色系统和黑色系统

白色系统是指一个系统的内部特征完全已知，即系统的信息是完全充分的。

黑色系统即完全未知的系统

灰色系统介于两者之间，部分已知，部分未知。

#### 灰色预测法

灰色预测是一种对含有不确定因素的系统进行预测的方法。通过鉴别系统因素之间发展趋势的相异成都，即进行关联分析，并可对原始数据进行处理来寻找系统变动的规律，生成有较强规律性的数据序列，然后建立相应的微分方程模型，从而预测事务未来发展趋势的状况。

灰色预测法用等时距观测到的反映预测对象特征的一系列数量值构造灰色预测模型，预测未来某一时刻的特征量，或达到某一特征量的时间。

#### 灰色预测常见的四种类型

1. 灰色时间序列预测
用观察到的反映对象特征的时间序列来构造灰色预测模型，预测未来某一时刻的特征量。

2. 畸变预测
通过灰色模型预测异常值出现的时刻或时区

3. 系统预测
通过对系统行为特征指标建立一组相互关联的灰色预测模型，预测系统中众多变量间的相互协调关系的变化。

4. 拓扑预测
将原始数据做曲线，在曲线上按定值寻找给定值发生的所有时间点，并以该定值为框架构成时点数列，然后建立模型预测该定值所发生的时点。

#### 灰色关联度

选取参考数列$X_0$

现有m个比较数列$X_i$

则称
$$
\xi_i(k) = \frac{\min_i\min_k|X_0(k) - X_i(k) + \rho\max_i\max_k|X_0(k) - X_i(k)|}{|X_0(k) - X_i(k)| + \rho\max_i\max_k|X_0(k) - X_i(k)|}
$$
为比较数列$X_i$对参考数列在k时刻的关联系数。其中$\rho\in [0,1]$为分辨系数。

n个时刻的关联系数的算术平均值称为比较数列$X_i$对参考数列$X_0$的关联度。

#### 优势分析

当参考数列不止一个，被比较的因素也不止一个时，则需要进行优势分析。

假设有m个参考数列和l个被比较数列。则两两进行关联度计算可以得到m×l个关联度。设$r_{ij}$表示比较数列$x_j$对被比较数列$y_i$的关联度，可构造关联度矩阵$R = (r_{ij}_{m\times l})_$

根据关联度矩阵各元素的大小，可以判断出哪些元素起主要影响。当某一列的元素大于其它列元素时，称此列所对应的子元素为优势子元素。当某一行的元素大于其余元素时，称此行的对应的母元素为优势母元素。

### 生成数

灰色系统理论把一切随机量都看做灰色数。对灰色数的处理不是找概率分布或求统计规律，而是利用数据处理的办法去寻找数据间的规律。通过对数列中的数据进行处理，产生新的数列，以此来挖掘和寻找数的规律性的方法，叫做**数的生成**。数的生成方式有多种: 累计生成、累减生成以及加权累加等等。

#### 累加生成

把数列x各时刻数据依次累加的过程叫做累加过程，记作AGO。即对于原始数列$x^0$，其累加数列为
$$
x^{(1)}(k) = \sum_{i=\alpha}x^{(0)}(i), k = \alpha, \dots,n
$$

当$\alpha=1$时称为一般累加生成，否则称为去首累加生成。

#### 累减生成

$$
x^{(r-1)}(k) = x^{(r)}(k) - x^{(r)}(k-1), k = 2,3,\dots,n
$$

### 灰色模型GM

灰色系统理论是基于关联空间、光滑离散函数等号概念定义灰导数与灰微分方程，进而用离散数据建立微分方程形式的动态模型，由于这时本征灰色系统的基本模型，而且模型是近似的、非唯一的，故这种模型为灰色模型，GM。

即灰色模型是利用离散随机数经过生成变为随机性被显著削弱而且较有规律的生成数，建立起的微分方程形式的模型，这样便于对其变化过程进行研究和描述。

#### GM(1,1)模型

设$x^{(0)}$为n个元素的数列，$x^{(1)}$为其累加生成的数列。则定义$x^{(1)}$的导数为
$$
dx^{(1)}(k) = x^{(0)}(k)
$$

令$z^{(1)}$为数列$x^{(1)}$的紧邻均值数列，即
$$
z^{(1)}(k) = 0.5x^{(1)}(k) + 0.5x^{(1)}(k-1), k = 2,3,\dots,n
$$

于是定义GM(1,1)的灰微分方程模型为
$$
x^{(0)}(k) + az^{(1)}(k) = b \tag{7}
$$

其中$x^{(0)}(k)$称为灰导数，a称为发展系数，$z^{(1)}(k)$称为白化背景值，b称为灰作用量。

#### GM(1,1)的白化型

对于GM(1,1)的灰微分方程，如果将$x^{(0)}(k)$的时刻视为连续的变量t,则数列$x^{(1)}$可以视为时间的函数。于是得到GM(1,1)的灰微分方程对应的白微分方程为
$$
\frac{dx^{(1)}}{dt} + ax^{(1)} = b
$$

#### GM(1,N)模型

GM(1,1)即表示模型为1阶方程，只含有一个1个变量的灰色模型，而GM(1,N)即表示模型是1阶方程，包含有N个变量的灰色模型。

设系统有N个行为因子，即原始数列为
$$
x_i^{(0)} = (x_i^{(0)}(1), x_i^{(0)}(2),\dots,x_i^{(0)}(n)), i = 1,2,\dots,N
$$

$x_i^{(1)}$为$x_i^{(0)}$的AGO数列

定义GM(1,N)的灰微分方程为
$$
x^{(0)}(k) + az_1^{(1)}(k) = \sum_{i=2}^Nb_ix^{(1)}_i(k)_
$$

白化微分方程为
$$
\frac{dx_1^{(1)}}{dt} + ax_1^{(1)}(t) = \sum_{i=2}^Nb_ix_i^{(1)}(t)
$$

### 灰色预测

灰色预测是指利用GM模型对系统行为特征的发展变化规律进行估计预测，同时也可以对行为特征的异常情况发生的时刻进行估计计算，以及对在特定时区内发生事件的未来事件分布情况做出研究等等。

#### 灰色预测的方法

根据参考数列，建立相应的灰微分方程为
$$
x^{(0)}(k) + az^{(1)}(k) = b, k = 2,3,\dots,n
$$

记
$$
u = (a,b)^T, \\Y = (x^{(0)}(2),\dots, x^{(0)}(n))^T\\
B = \begin{bmatrix}
-z^{(1)}(2) & 1\\
-z^{(1)}(3) & 1\\
\vdots & \vdots\\
-z^{(1)}(n) & 1
\end{bmatrix}
$$

利用最小二乘法，要求使得$J(\hat u) = (Y - B\hat u)(Y - B\hat u)$达到最小值的$\hat u = (a,b)^T = (B^TB)^{-1}B^TY$

解得方程为
$$
x^{(1)}(k+1) = (x^{(0)}(1) - \frac ba)e^{-ak} + \frac ba, k = 0,1,\dots,n-1
$$

#### 灰色预测的步骤

1. 数据的检验与处理
首先，为了保证建模方法的可行性，需要对已知数据做必要的检验处理。

计算数列的级比
$$
\lambda(k) = \frac{x^{(0)(k-1)}}{x^{(0)}(k)}, k = 2,3,\dots,n
$$

如果所有级比都落在可容覆盖$\Theta = (e^{-\frac2{n+1}}, e^{\frac2{n+2}})$内，则数列$x^{(0)}$可以作为模型GM(1,1)的数据进行灰色预测。否则需要进行必要的平移变换。

2. 建立模型
按照上文中提到的方法建立模型，就可以得到k+1时刻的预测值

3. 检验预测值
令$\hat{x}^{(0)}(1) = x^{(0)}(1)$,计算
$$
\varepsilon(k) = \frac{x^{(0)}(k) - \hat{x}^{(0)}(k)}{x^{(0)}(k)}, k = 1,2,\dots,n
$$
如果小于0.2，则认为达到一般要求。


